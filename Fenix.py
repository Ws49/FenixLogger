from multiprocessing import connection
import socket
from http import client
import os

fenix = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
fenix.settimeout(None)
fenix.bind(('localhost', 8080))
fenix.listen(1)

os.system("color 2")           

print("███████╗                      ███████╗                      ███╗░░██╗                      ██╗                      ██╗░░██╗")
print("██╔════╝                      ██╔════╝                      ████╗░██║                      ██║                      ╚██╗██╔╝")
print("█████╗░░                      █████╗░░                      ██╔██╗██║                      ██║                      ░╚███╔╝░")
print("██╔══╝░░                      ██╔══╝░░                      ██║╚████║                      ██║                      ░██╔██╗░")
print("██║░░░░░                      ███████╗                      ██║░╚███║                      ██║                      ██╔╝╚██╗")
print("╚═╝░░░░░                      ╚══════╝                      ╚═╝░░╚══╝                      ╚═╝                      ╚═╝░░╚═╝")
                                                                                                   
print("              ##                                                                                        @@                                   ")       
print("            ##########                                                                              ########                                 ")     
print("              ############                                                                      ++########                                   ")   
print("      MM    mm++++::mm######                                                                  ######mm::++      ##                           ") 
print("      mm##@@######mm--..MM######                                                            ######..::mm##########                           ")
print("      ++######--####@@..  ########MM                                                    ########  ..++####--######                           ")
print("      ::######--  ::##....@@##::########                                          mm######MM####----@@..  ####@@                             ")
print("        ::MM####      --########  MM##++##                                      ########--  ######..--  ..####                               ")
print("    ##  ++::##::##      ..--######  ####::##                                  mm##..##..  ####@@      ++####                                 ")
print("    ####++####  --@@##      ..mm##    ##--##                                  ##  ####  --##--..    ##@@  ####  ####                         ")
print("      ##########      mm##      mm....####  ##                              mm##  ####  ##..    ####      ########                           ")
print("        ++######..    ......##    ######    ##                              @@--  ####  ::  --@@        ########                             ")
print("       --..--  @@####        ##::########@@  ##                              ##..##########--::..      ####mm                                ")
print("       ####@@..    --mm##..  ++@@MM####@@@@  ##                              ##::########++####  ::##@@      ##@@####                        ")
print("         ######        ..  ::##  ##mm##MM##  ##          ##::####            @@mm##########++MM++  --      ++######                          ")
print("             ######          --::@@##  ####..##        ##########            ##--@@@@####@@MM++        ..######                              ")
print("           ::############        --##@@####  ##            ##@@  ##        ####  ##mm####..        MM########                                ")
print("           ######    --::@@##MM--  MM######  ####          ##    ##      ####MM--######..mm--++##@@::..  --####                              ")
print("           mm##@@##    ..      ::    ######MM  MM##        mm  ..--##MM::      ########--                ######                              ")
print("           MMMM######mm--....--##  ..##mm##@@##      @@####  ..##  ##--  --mm##########    MM--..::--########                                ")
print("             ########::          @@++######@@mm##########::######++########@@########..####          ..@@####                                ")
print("               mm##########@@--        ######@@##mm####MM  @@  mm..######::########::    ::  --############                                  ")
print("               ######  ..++mm        mm..##########MMMM####----::mm####MM########::  ::--..          ..######                                ")
print("               ######..  ....::::##..    --######@@####mm##########  ############--    ++##....++      ######                                ")
print("                 ##############@@              ..####MM##..--####--  ######++        ..    ++##############                                  ")
print("                 ::##########        --      ++    --####  ::..##..  ##      ::      ##--      MM########                                    ")
print("                   ::::####--    ::++##    ##        ..  ##    mm....##..      ##++    @@++::    ####                                        ")
print("                   ##################--##--    --  --    ##::::::MM##..++--..      ####--################                                    ")
print("                     ##########            ::mm    ....  ##  ----##++  ##  ..++..            ##########                                      ")
print("                       ######      ..--++++##      ++..  ##      ##  ..##    ++##mm++----      ######                                        ")
print("                           ################  ..--##--    ##..    ##  mm##++mm  ..################                                            ")
print("                           ::::::++@@##@@  ..::++##..  ..##  --..mmmm    ##++--    ####                                                      ")
print("                             MM######..  ..--::##--mm  ####....  @@##  ::::##::--    ..######                                                ")
print("                             --::..    ..::::##mm++  ++@@##----::####++  mm++##++..                                                          ")
print("                                 ..    --mm##MMMM  ..##--::##MMmm++####....++####++                                                          ")
print("                                   --mm@@####..++::####..--::##mm  @@##..MM--MM######                                                        ")
print("                                       @@##  MM####::--##::##::##mm##..  ####++  ##                                                          ")
print("                                       mm--######    ##MM####@@########..  ######MM                                                          ")
print("                                           ..####@@####  ####--####@@  ########                                                              ")
print("                                           ----MM##@@    ++##  ####      ##@@::--                                                            ")
print("                                                   --    ####  ..##          ::                                                              ")
print("                                                         ##      ##                                                                          ")
print("                                                                 ::                                                           by Ws49        ")
                                                                                                                                            
                                                                                                                                          
print("\n\n\n██╗░░░░░ ██╗ ░██████╗ ████████╗ ███████╗ ███╗░░██╗ ██╗ ███╗░░██╗ ░██████╗░ ░░░ ░░░ ░░░")
print("██║░░░░░ ██║ ██╔════╝ ╚══██╔══╝ ██╔════╝ ████╗░██║ ██║ ████╗░██║ ██╔════╝░ ░░░ ░░░ ░░░")
print("██║░░░░░ ██║ ╚█████╗░ ░░░██║░░░ █████╗░░ ██╔██╗██║ ██║ ██╔██╗██║ ██║░░██╗░ ░░░ ░░░ ░░░")
print("██║░░░░░ ██║ ░╚═══██╗ ░░░██║░░░ ██╔══╝░░ ██║╚████║ ██║ ██║╚████║ ██║░░╚██╗ ░░░ ░░░ ░░░")
print("███████╗ ██║ ██████╔╝ ░░░██║░░░ ███████╗ ██║░╚███║ ██║ ██║░╚███║ ╚██████╔╝ ██╗ ██╗ ██╗")
print("╚══════╝ ╚═╝ ╚═════╝░ ░░░╚═╝░░░ ╚══════╝ ╚═╝░░╚══╝ ╚═╝ ╚═╝░░╚══╝ ░╚═════╝░ ╚═╝ ╚═╝ ╚═╝  ")                                                                                          
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
                                                                                                                                            
while True:
    connection, address = fenix.accept()
    received_bytes = b''
    
    while True:
        data = connection.recv(1024)
        if not data:
            break
        if data.endswith(b"END_OF_FILE"):
            received_bytes += data[:-len(b"END_OF_FILE")]
            break
        received_bytes += data
    try:
        decode_data = received_bytes.decode('utf-8')
    except UnicodeDecodeError:
        decode_data = received_bytes.decode('utf-8', errors='ignore')
        
        
    myconnection =  decode_data.split(";")[len(decode_data.split(";")) - 2]
    myconnection +=";;"
    received_bytes += received_bytes[:-len(myconnection.encode())]
    
    myconnection = myconnection.replace(";;","")
    
    namefile = "logs[" + str(myconnection) + "].txt"
    with open(namefile, 'wb') as file:
            file.write(received_bytes)
        
            
    print(f'[{namefile}] - >  received  ')